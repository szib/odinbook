<% unless current_user.friend_of?(friend) %>

  <% unless current_user.has_pending_friend_request?(friend) %>
    <%= form_tag friend_request_path(friend) do %>
      <%= submit_tag 'Send friend request', class: "btn btn-primary" %>
    <% end %>
  <% else %>
    <% if current_user.has_sent_friend_request_to?(friend) %>
      <%= form_tag friend_request_path(friend), method: :delete do %>
        <%= submit_tag 'Delete request', class: "btn btn-primary" %>
      <% end %>
    <% else %>
      <%= form_tag friend_request_path(friend), method: :put do %>
        <%= submit_tag 'Accept request', class: "btn btn-primary" %>
      <% end %>
      <%= form_tag friend_request_path(friend), method: :delete do %>
        <%= submit_tag 'Delete request', class: "btn btn-primary" %>
      <% end %>
    <% end %>
  <% end %>

<% else %>
  <span>Your friend</span>
<% end %>
